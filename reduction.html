<html>
<body>

<table>

<tbody>

<tr>

<td valign="top" width="300"  style="font-family:monospace">
<h2>Руководство по IRAF</h2>
&#9675; <a href="index.html">Установка IRAF под Linux</a><br>
&#9675; <a href="login.html">Настройка IRAF (login.cl)</a><br>
&#9675; <a href="cl.html">Командная строка IRAF</a><br>
&#9675; <a href="file.html">Работа с файлами в IRAF</a><br>
&#9675; <a href="package.html">Работа с пакетами IRAF</a><br>
&#9675; <a href="task.html">Работа с командами IRAF</a><br>
&#9679; Первичная обработка снимков<br>
&#9675; <a href="align.html">Выравнивание снимков</a><br>
&#9675; <a href="apphot.html">Апертурная фотометрия</a><br>
&#9675; <a href="psfphot.html">PSF-фотометрия</a><br>
&#9675; <a href="script.html">Работа со скриптами в IRAF</a><br>
&#9675; <a href="example.html">Примеры задач</a><br>
&#9675; <a href="reference.html">Справочник команд IRAF</a><br>
&#9675; <a href="envvar.html">Переменные среды IRAF</a>
</td>

<td style="font-family:monospace">

<h3>Первичная обработка снимков</h3>

<p>Для создания master-bias, master-dark и master-flat в IRAF используются соответствующие команды - zerocombine, darkcombine и flatcombine - из пакета noao.imred.ccdred, в котором параметру instrument по умолчанию (сразу после установки IRAF на компьютере) не задано какое-либо значение. Убедиться в этом можно, просмотрев список параметров пакета:

<p style="background-color:lightgray">lpar ccdred

<p>Если оставить значение этого параметра пустым, то при попытке выполнить одну из этих трёх команд будет появляться сообщение об ошибке - не указан трансляционный файл инструмента:

<p style="background-color:lightgray">ERROR: No 'instrument' translation file specified.

<p>Поэтому перед использованием вышеупомянутых команд требуется задать нужное имя трансляционного файла инструмента. Для этого сначала в командной строке IRAF перейти в директорию /iraf/iraf/noao/imred/ccdred/ccddb/ и создать в ней новую директорию, например, по названию обсерватории, по аналогии с директорией kpno, уже находящейся там и содержащей трансляционные файлы разных инструментов обсерватории Kitt Peak National Observatory:

<p style="background-color:lightgray">cd /iraf/iraf/noao/imred/ccdred/ccddb/
<p style="background-color:lightgray">!sudo mkdir имя-новой-директории

<p>Затем перейти в новую директорию и создать в ней пустой файл "имя-файла.dat", именем файла целесообразно выбрать некое обозначение фактически используемого инструмента, например, fli.dat, если в качестве инструмента используется FLI ПЗС-камера:

<p style="background-color:lightgray">cd имя-новой-директории
<p style="background-color:lightgray">!sudo touch имя-файла.dat

<p>И наконец, задать этот файл как значение параметра instrument пакета ccdred:

<p style="background-color:lightgray">ccdred.instrument = "ccddb$имя-новой-директории/имя-файла.dat"

<hr>

<h4>Master-Bias</h4>

<p>

<hr>

<h4>Master-Dark</h4>

<p>Master-dark создаётся из нескольких исходных темновых кадров командой darkcombine. Фактически команда darkcombine является своего рода оболочкой - она, приняв определённые значения параметров и список исходных темновых кадров, передаёт их далее и автоматически инициирует другие две команды пакета ccdred, а именно ccdproc и combine. Поэтому сначала следует отредактировать значения некоторых параметров команды darkcombine.

<p>Для параметра output задаём желаемое название master-dark файла, например, masterdark; по умолчанию название будет Dark; здесь не обязательно указывать расширение файла .fit, оно будет автоматически добавлено к имени итогового master-dark файла.

<p>В параметре combine задаём тип комбинирования пикселей исходных темновых кадров, либо average - усреднение (этот тип задан по умолчанию), либо median - по медиане; как правило, рекомендуется использовать второй тип.

<p>Параметру ccdtype по умолчанию задано значение dark - это значит, что master-dark будет создан исключительно из кадров имеющих тип dark. Тип любого кадра задаётся в его заголовке неким ключевым словом, и оно может быть различным у кадров с разных инструментов. IRAF определяет тип кадра по ключевому слову imagetyp в заголовке кадра, поэтому если параметр ccdtype оставить со значением dark, но при попытке выполнить команду darkcombine IRAF не найдёт кадров с ключевым словом imagetyp в заголовке, то появится сообщение об ошибке - отсутствуют кадры для комбинирования:

<p style="background-color:lightgray">ERROR: No images to combine

<p>Устранить эту ошибку можно двумя способами:

<p>1) В трансляционном файле инструмента задать трансляцию между ключевым словом imagetyp и тем ключевым словом, которое фактически используется в заголовке кадра для обозначения типа кадра (например, EXPTYPE). Если на данный момент трансляционный файл инструмента пуст, то из командной строки IRAF можно добавить соответствующую трансляцию в нужный трансляционный файл инструмента:

<p style="background-color:lightgray">cd /iraf/iraf/noao/imred/ccdred/ccddb/имя-директории-трансляционного-файла-инструмента
<p style="background-color:lightgray">!sudo sh -c "echo 'imagetyp ключевое-слово-из-заголовка-кадра' >> имя-трансляционного-файла-инструмента"

<p>Примечание: этой операции будет достаточно для безошибочной работы только в том случае, если в заголовке исходных темновых кадров значением для соответствующего ключевого слова является слово dark - именно оно принято в IRAF для обозначения типа темновых кадров; если же вместо dark в заголовке темновых кадров используется иное обозначение, тогда в трансляционный файл инструмента потребуется дополнительно на отдельной строке добавить трансляцию для фактически используемого обозначения:

<p style="background-color:lightgray">'обозначение-в-заголовке' dark

<p>2) Задать параметру ccdtype пустое значение (при использовании этого метода следует учитывать, что тогда команда darkcombine для создания master-dark будет использовать все доступные/указанные исходные кадры, не проверяя их фактический тип):

<p style="background-color:lightgray">darkcombine.ccdtype = ""

<p>Параметру process по умолчанию задано значение yes - это значит, что перед созданием master-dark исходные темновые кадры будут обработаны командой ccdproc с учётом значений всех её параметров, и если какой-то из них задан неверно или неточно, возможно появление какого-либо сообщения об ошибке, и команда darkcombine в итоге не создаст master-dark, поэтому для надёжности параметру process лучше задать значение no.

<p>После редактирования параметров, если выполнить команду darkcombine без указания исходных темновых кадров, тогда в командной строке IRAF появится просьба указать их список:

<p style="background-color:lightgray">darkcombine
<p style="background-color:lightgray">List of dark images to combine:

<p>Здесь можно либо нажать клавишу Enter, тогда будут использованы все кадры в текущей директории, либо указать как путь к директории с нужными кадрами, так и маску имени самих кадров (например, dark*.fit), либо указать текстовый файл содержащий список нужных кадров (например, @list.txt).

<p>После выполнения команды в текущей директории появятся два новых файла: собственно файл master-dark и текстовый файл logfile, в котором можно найти описание: когда была выполнена команда, с какими значениями некоторых параметров, с использованием каких исходных файлов и каково было их общее количество, а также название итогового файла master-dark. Если нужно, чтобы файл master-dark был создан в иной директории, то у команды darkcombine следует отредактировать значение параметра output, указав помимо названия файла также требуемый путь к директории.

<p>Однако можно сразу задать нужные исходные кадры в командной строке IRAF:

<p style="background-color:lightgray">darkcombine input="входные-данные"

<hr>

<h4>Master-Flat</h4>

<p>

<hr>

<h4>Вычитание Master-Bias / Master-Dark и деление на Master-Flat</h4>

<p>

<hr>

<p>Последнее изменение: 10.12.2017

</td>

</tr>

</tbody>

</table>

</body>
<html>
